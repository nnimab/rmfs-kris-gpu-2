# 混合模式評估指南

## 什麼是混合模式？

混合模式是 `evaluation_manager.sh` 的新評估模式，它結合了單一會話和多會話模式的優點：

- **每個控制器一個 screen 會話**：並行執行不同控制器
- **會話內依序執行多次運行**：避免過多並行進程
- **可控制的最大並行數**：防止系統過載

## 優點

1. **平衡的並行性**
   - 10 個控制器 = 10 個並行會話（而不是 30 個）
   - 每個會話內依序執行 3 次評估

2. **系統負載可控**
   - 可設定最大並行會話數（預設 8）
   - 自動等待空閒位置

3. **清晰的進度追蹤**
   - 每個控制器的進度獨立顯示
   - 容易查看特定控制器的執行狀況

## 使用方法

1. 執行 `./evaluation_manager.sh`
2. 選擇要評估的控制器
3. 設定評估參數（ticks、運行次數）
4. 選擇評估模式時選擇 **[3] 混合模式**
5. 設定最大並行數（建議不超過 CPU 核心數）

## 輸出結構

```
result/evaluations/BATCH_20250726_220000/
├── time_based/
│   ├── RUN_1/
│   ├── RUN_2/
│   └── RUN_3/
├── queue_based/
│   ├── RUN_1/
│   ├── RUN_2/
│   └── RUN_3/
└── nerl_nerl_step_a3000ticks/
    ├── RUN_1/
    ├── RUN_2/
    └── RUN_3/
```

## 監控執行

```bash
# 查看所有混合模式會話
screen -ls | grep rmfs_hybrid

# 連接到特定會話
screen -r rmfs_hybrid_time_based_xxxxx

# 分離會話（保持運行）
Ctrl+A 然後 D
```

## 建議設定

- **快速測試**：最大並行數 = CPU 核心數
- **正式實驗**：最大並行數 = CPU 核心數 / 2
- **資源受限**：最大並行數 = 4-6

## 注意事項

1. 每個會話會佔用約 1-2 GB 記憶體
2. NetLogo 狀態檔案會自動使用 SIMULATION_ID 避免衝突
3. 所有運行完成後記得執行聚合分析